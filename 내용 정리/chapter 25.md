# 25장 테스트 주도 개발 패턴

3부는 TDD의 인기 있는 패턴 모음

## 어떻게 테스트할 것인가

- 테스트한다는 것은 무엇을 뜻하는가?
- 테스트를 언제 해야 하는가?
- 테스트할 로직을 어떻게 고를 것인가?
- 테스트할 데이터를 어떻게 고를 것인가?

## 테스트 (명사)

- 아무리 작은 변화라도 테스트하지 않고 릴리즈하지 않는다.
- 제랄드 와인버그의 Quality Software Management의 스타일의 영향도
    - 양성 피드백 고리
    - 스트레스를 많이 받으면 테스트를 점점 더 뜸하게 한다.
    - 테스트를 뜸하게 하면 에러는 점점 많아질 것이다.
    - 에러가 많아지면 더 많은 스트레스를 받게 된다.
- 이 고리를 빠져나오는 법
    - 자동화된 테스트
        - 스트레스를 받기 시작할 때 테스트를 시작할 것
        - 테스트함으로써 좋은 느낌을 받고 에러가 낼 일이 줄어들며 스트레스도 적어진다.

## 격리된 테스트

- 테스트를 실행하는 것은 서로 아무 영향이 없어야 한다.
- 교훈
    - 테스트가 충분히 빨라서 직접 자주, 실행할 수 있게끔 하자
    - 앞 부분에서 실행된 테스트가 실패한 후 그 영향으로 다음 테스트부터는 시스템이 예측 불가능한 경우가 허다하다.
    - 테스트는 작은 스케일로 하는 게 좋다.
    - 각각의 테스트는 다른 테스트와 완전히 독립적이어야 한다.

## 테스트 목록

- 시작하기 전에 작성해야 할 테스트 목록을 모두 적어둘 것
    - 구현해야 할 것들에 대한 테스트를 작성
    
- 테스트를 전부 만들어 놓는 방법이 별로인 이유
    - 매개 변수의 순서를 바꿔야 하는 경우 리팩토링하지 않으려 할 수도
    - 초록 막대를 빨리 보는 방법은 실패하는 테스트들을 다 지워버리는 것
- 테스트를 통과하게 만드는 과정에서 새로운 테스트가 필요함을 알게 된다.

## 테스트 우선

- 테스트는 테스트 대상이 되는 코드를 작성하기 직전에 작성하는 것이 좋다.
- 테스트를 먼저하면 스트레스가 줄고 테스트를 더 많이 하게된다.

## 단언 우선

- 단언 assert는 언제 쓸까?
- 단언을 제일 먼저 쓰고 시작하라
    - 작업을 단순하게 만드는 효과
    - assert를 위해서 다른 작업들을 채워넣음
    
    
    ```java
    void testCompleteTransaction() {
    	Server writer = Server(defaultPort(), "abc");
    	Socket reader = Socket("localhost", defaultPort());
    	Buffer reply = reader.contents();
    	assertTrue(reader.isClosed());
    	assertEquals("abc", reply.contents());
    }
    ```
    

## 테스트 데이터

- 테스트를 읽을 때 쉽고 따라가기 좋을 만한 데이터를 사용하라
- 1과 2의 개념적 차이가 없다면 1을 사용하라
- 세 항목만으로 동일한 설계와 구현을 이끌어낼 수 있다면 굳이 열개나 할 필요는 없다.
- 실제 데이터를 사용하는 경우도 있다.

## 명백한 데이터

- 데이터의 의도는 어떻게 표현할 것인가
    - 테스트 자체에 예상되는 값과 실제 값을 포함하고 이 둘 사이의 관계를 드러내기 위해 노력하라
